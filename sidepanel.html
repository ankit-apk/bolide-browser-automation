<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Web Assistant</title>
    <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
    <div class="sidebar-container">
        <header class="header">
            <h1>🤖 AI Assistant</h1>
            <div class="header-info">
                <span class="model-badge">Gemini 2.5 Flash</span>
                <span class="status-badge" id="statusBadge">Ready</span>
            </div>
        </header>

        <div class="api-section">
            <div class="api-input-group">
                <input type="password" id="apiKey" placeholder="Enter Gemini API Key">
                <button id="saveApiKey" class="btn-save">Save</button>
            </div>
        </div>

        <div class="mode-selector">
            <button id="taskModeBtn" class="mode-btn active">📋 Task Mode</button>
            <button id="workflowModeBtn" class="mode-btn">🔄 WebSocket Mode</button>
            <button id="multiTabBtn" class="mode-btn">🌐 Multi-Tab</button>
            <button id="liveModeBtn" class="mode-btn">🔴 Live Mode</button>
        </div>

        <div class="task-input-section" id="taskSection">
            <textarea id="taskInput" 
                      placeholder="What would you like me to do? E.g., 'Find a hotel in Paris', 'Book a flight to London', 'Search for best restaurants'..."
                      rows="3"></textarea>
            <div class="controls">
                <button id="startTask" class="btn-primary">
                    <span class="btn-icon">▶</span> Start Task
                </button>
                <button id="startContinuous" class="btn-primary" style="display: none;">
                    <span class="btn-icon">♻️</span> Continuous Mode
                </button>
                <button id="startWebSocket" class="btn-primary" style="display: none;">
                    <span class="btn-icon">🔄</span> Real-time Mode
                </button>
                <button id="startMultiTab" class="btn-primary" style="display: none;">
                    <span class="btn-icon">🌐</span> Multi-Tab Workflow
                </button>
                <button id="stopTask" class="btn-danger" disabled>
                    <span class="btn-icon">■</span> Stop
                </button>
            </div>
        </div>

        <div class="live-mode-section" id="liveSection" style="display: none;">
            <div class="live-status">
                <span class="live-indicator">⚫</span>
                <span id="liveStatusText">Not streaming</span>
            </div>
            <div class="live-info">
                <p>🎥 Live Mode shares your screen with Gemini in real-time</p>
                <p>📸 Screenshots sent every 1 second</p>
                <p>🎯 Only clicks, taps, typing, and scrolling allowed</p>
            </div>
            <div class="live-chat">
                <input type="text" id="liveMessageInput" placeholder="Talk to Gemini about what you see..." disabled>
                <button id="sendLiveMessage" class="btn-send" disabled>Send</button>
            </div>
            <div class="controls">
                <button id="startLive" class="btn-primary">
                    <span class="btn-icon">🔴</span> Start Live Mode
                </button>
                <button id="stopLive" class="btn-danger" disabled>
                    <span class="btn-icon">⏹</span> Stop Live
                </button>
            </div>
        </div>

        <div class="workflow-section">
            <h3>Current Workflow</h3>
            <div id="workflowSteps" class="workflow-steps">
                <div class="empty-state">No active task</div>
            </div>
        </div>

        <div class="log-section">
            <div class="log-header">
                <h3>Activity Log</h3>
                <button id="clearLog" class="btn-small">Clear</button>
            </div>
            <div id="activityLog" class="activity-log"></div>
        </div>

        <div class="page-info-section">
            <h3>Current Page</h3>
            <div id="pageInfo" class="page-info">
                <div class="info-row">
                    <span class="info-label">URL:</span>
                    <span id="currentUrl" class="info-value">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Title:</span>
                    <span id="currentTitle" class="info-value">-</span>
                </div>
            </div>
        </div>

        <div class="progress-section">
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
            <div id="progressText" class="progress-text">Ready to start</div>
        </div>
    </div>

    <script src="sidepanel.js"></script>
</body>
</html>